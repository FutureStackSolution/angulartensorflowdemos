<div class="container">
  <mat-card class="tracker-card">
    <mat-card-header>
      <mat-card-title>Pupil Concentration Tracker</mat-card-title>
      <mat-card-subtitle>Monitor student focus levels in real-time</mat-card-subtitle>
      <mat-card-subtitle>Please concentrate on the webcam</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content class="two-column-layout">
      <div class="metrics-column">
        <div class="concentration-meter">
          <h3>Current Concentration Level</h3>
          <mat-progress-bar 
            [value]="concentrationLevel" 
            [color]="concentrationLevel > 70 ? 'primary' : concentrationLevel > 40 ? 'accent' : 'warn'">
          </mat-progress-bar>
          <div class="concentration-value">{{ concentrationLevel | number : '1.2-2' }}%</div>
        </div>
        
        <div class="stats-container">
          <h3>Live Metrics</h3>
          <ul>
            <li>Left Pupil Size: {{ leftPupilSize | number:'1.2-2'}} pixels</li>
            <li>Right Pupil Size: {{ rightPupilSize | number:'1.2-2'}} pixels</li>
          </ul>
        </div>

        <mat-card-actions>
          @if(isTracking==false){
          <button mat-raised-button color="primary" (click)="startTracking()" >
            Start Tracking
          </button>
          }
          
          @if(isTracking==true){
            <button mat-raised-button color="warn" (click)="stopTracking()" >
              Stop Tracking
            </button>
            <span>&nbsp;</span>
            <button mat-stroked-button color="accent" (click)="recalibrate()" [disabled]="!isCalibrated" title="Recalibrate baseline pupil size">
              Recalibrate
            </button>
          }
          
          </mat-card-actions>
      </div>
      
      <div class="camera-column">
        <div class="video-container">
         
          <video #video width="640" height="480" autoplay playsinline muted [hidden]="!isTracking"></video>
          <canvas #canvas width="640" height="480" [hidden]="!isTracking"></canvas>
          @if(isTracking==false){
            <div class="placeholder-video">
              <p>Camera feed will appear here when tracking is active</p>
            </div>
          }
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>